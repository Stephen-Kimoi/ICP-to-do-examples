# 📁 Project Structure Overview

```
post-likes-tutorial/
├── 📁 src/
│   └── 📁 post-likes-backend/          # Rust canister source
│       ├── 📄 Cargo.toml               # Rust dependencies
│       ├── 📄 post-likes-backend.did   # Candid interface
│       └── 📁 src/
│           └── 📄 lib.rs               # Canister implementation
├── 📁 web2-api/                        # Node.js Web2 API
│   ├── 📄 package.json                 # Node.js dependencies
│   ├── 📄 server.js                    # Express server + ICP integration
│   └── 📄 test-client.js              # Test script
├── 📄 dfx.json                         # DFX project configuration
├── 📄 Cargo.toml                       # Rust workspace configuration
├── 📄 setup.sh                         # Automated setup script
├── 📄 demo.sh                          # Complete demo script
├── 📄 README.md                        # Comprehensive tutorial guide
└── 📄 PROJECT_STRUCTURE.md             # This file
```

## 🔧 Key Components

### **1. Rust Canister (`src/post-likes-backend/`)**
- **Purpose**: Stores like counts on ICP (tamper-proof storage)
- **Key Files**:
  - `lib.rs`: Main canister logic with `like()` and `get_likes()` functions
  - `post-likes-backend.did`: Candid interface defining the API
  - `Cargo.toml`: Rust dependencies (ic-cdk, candid)

### **2. Web2 API (`web2-api/`)**
- **Purpose**: Express server that integrates with ICP canister
- **Key Files**:
  - `server.js`: Main server with HTTP endpoints and ICP agent integration
  - `test-client.js`: Test script demonstrating the full integration
  - `package.json`: Node.js dependencies (@dfinity/agent, express, etc.)

### **3. Configuration Files**
- **`dfx.json`**: DFX project configuration for canister deployment
- **`Cargo.toml`**: Rust workspace configuration
- **`.env`**: Environment variables (auto-generated by demo script)

### **4. Automation Scripts**
- **`setup.sh`**: Initial project setup and dependency installation
- **`demo.sh`**: Complete workflow from network start to testing

## 🔄 Data Flow

```
1. User Request → Web2 API (Express)
2. Web2 API → ICP Agent (JavaScript)
3. ICP Agent → ICP Canister (Rust)
4. ICP Canister → Response (likes count)
5. Response → Web2 API → User
```

## 🚀 Getting Started

### **Quick Start (Automated)**
```bash
# Run the complete demo
./demo.sh
```

### **Manual Setup**
```bash
# 1. Setup dependencies
./setup.sh

# 2. Start local network
dfx start --background

# 3. Deploy canister
dfx deploy post-likes-backend

# 4. Generate bindings
dfx generate post-likes-backend

# 5. Start Web2 API
cd web2-api && npm start

# 6. Test integration
node test-client.js
```

## 📊 API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/health` | Health check |
| `GET` | `/likes/:postId` | Get likes for a post |
| `POST` | `/like/:postId` | Like a post |
| `GET` | `/posts` | Get all posts with likes |

## 🔑 Key Integration Points

### **ICP Agent Setup (server.js)**
```javascript
// Create identity for server-side calls
const identity = Ed25519KeyIdentity.fromSeedPhrase(seed);

// Initialize agent
const agent = new HttpAgent({ identity, host });

// Create actor
const actor = Actor.createActor(idlFactory, { agent, canisterId });
```

### **Canister Calls**
```javascript
// Query call (fast, read-only)
const likes = await actor.get_likes(postId);

// Update call (slower, modifies state)
const newLikes = await actor.like(postId);
```

## 🧪 Testing

### **Test Client Features**
- Health check verification
- Initial state inspection
- Like operations testing
- State verification
- Multiple post testing
- Bulk operations

### **Manual Testing**
```bash
# Health check
curl http://localhost:3000/health

# Get likes
curl http://localhost:3000/likes/post-1

# Like a post
curl -X POST http://localhost:3000/like/post-1
```

## 🔍 Troubleshooting

### **Common Issues**
1. **Canister not found**: Run `dfx deploy post-likes-backend`
2. **Bindings missing**: Run `dfx generate post-likes-backend`
3. **Network not ready**: Wait for `dfx start` to complete
4. **Port conflicts**: Check if port 3000 is available

### **Debug Commands**
```bash
# Check canister status
dfx canister status post-likes-backend

# View canister logs
dfx canister call post-likes-backend get_likes '("post-1")'

# Check network status
dfx ping
```

## 📚 Next Steps

After understanding this structure, you can:
1. **Extend the canister**: Add more data fields or functions
2. **Enhance the API**: Add authentication, rate limiting, etc.
3. **Add frontend**: Create a web interface
4. **Deploy to mainnet**: Move from local development to production
5. **Scale up**: Add more canisters for different features

---

**💡 Tip**: Start with the `demo.sh` script to see everything working, then explore individual components to understand how they fit together.
